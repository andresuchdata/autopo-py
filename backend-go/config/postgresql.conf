# PostgreSQL configuration file
# ===================================================

# CONNECTIONS AND AUTHENTICATION
# ---------------------------------------------------
listen_addresses = '*'          # Listen on all interfaces
port = 5432                     # Default port
max_connections = 100           # Maximum number of concurrent connections

# RESOURCE USAGE
# ---------------------------------------------------
shared_buffers = 128MB          # Recommended: 25% of available RAM
work_mem = 4MB                  # Memory for sorting operations
maintenance_work_mem = 64MB     # Memory for maintenance operations

# QUERY TUNING
# ---------------------------------------------------
effective_cache_size = 4GB      # Estimate of how much memory is available for disk caching

# WRITE AHEAD LOG
# ---------------------------------------------------
wal_level = replica             # Minimal required for TimescaleDB
synchronous_commit = on         # Ensure crash safety

# REPLICATION
# ---------------------------------------------------
max_wal_senders = 10            # Maximum number of WAL sender processes
wal_keep_size = 1024MB          # Size of WAL files to keep for replication

# TIMESCALEDB
# ---------------------------------------------------
shared_preload_libraries = 'timescaledb'
# Enable TimescaleDB extension
# timescaledb.telemetry_level = 'off'  # Disable telemetry

# LOGGING
# ---------------------------------------------------
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_rotation_age = 1d
log_rotation_size = 100MB
log_min_messages = warning
log_min_error_statement = error
log_min_duration_statement = 1000  # Log slow queries (in milliseconds)

# CLIENT CONNECTION DEFAULTS
# ---------------------------------------------------
# These settings are initialized on new connections
# and can be changed per session

# LOCALE AND FORMATTING
# ---------------------------------------------------
datestyle = 'iso, mdy'
timezone = 'UTC'
lc_messages = 'en_US.utf8'
lc_monetary = 'en_US.utf8'
lc_numeric = 'en_US.utf8'
lc_time = 'en_US.utf8'

# DEFAULTS FOR TEXT SEARCH
# ---------------------------------------------------
default_text_search_config = 'pg_catalog.english'
